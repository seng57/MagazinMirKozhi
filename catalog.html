<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>–ö–∞—Ç–∞–ª–æ–≥ –∫–∞—Ç–µ–≥–æ—Ä–∏–π ‚Äî –ú–∏—Ä –∫–æ–∂–∏ –∏ –∞–≤—Ç–æ—Ç–∫–∞–Ω–µ–π</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>

  <div class="smoke-overlay"></div>

  <header class="header">
    <div class="container">
      <h1 class="logo">–ú–∏—Ä –∫–æ–∂–∏ –∏ –∞–≤—Ç–æ—Ç–∫–∞–Ω–µ–π</h1>
      <nav>
        <ul class="nav">
          <li><a href="index.html">–ì–ª–∞–≤–Ω–∞—è</a></li>
          <li><a href="catalog.html" class="active">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <section class="section fade-up catalog-section">
    <h2 class="section-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–æ–¥—É–∫—Ü–∏–∏</h2>
    <div id="cards" class="cards"></div>
  </section>

  <!-- —Å–∫—Ä—ã—Ç–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å -->
  <div id="adminToolbar"
       style="display:none; position:fixed; top:10px; right:10px; z-index:1001;">
    <button onclick="openAdminMenu()" title="–ü–∞–Ω–µ–ª—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞">‚öôÔ∏è</button>
    <button onclick="logoutAdmin()"      title="–í—ã–π—Ç–∏ –∏–∑ –∞–¥–º–∏–Ω–∫–∏">üö™</button>
  </div>

  <div id="loginForm"
       style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%);
              background:#fff; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.3);
              border-radius:8px; width:300px; z-index:1002;">
    <strong>–ê–¥–º–∏–Ω-–≤—Ö–æ–¥</strong>
    <input id="adminPassword" type="password" placeholder="–ü–∞—Ä–æ–ª—å"
           style="width:100%; margin:8px 0; padding:8px;"/>
    <button onclick="checkPassword()" style="width:100%; padding:8px;">–í–æ–π—Ç–∏</button>
  </div>

  <div id="adminMenu"
       style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%);
              background:#fff; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.3);
              border-radius:8px; width:300px; z-index:1002;">
    <h3>–ê–¥–º–∏–Ω-–º–µ–Ω—é</h3>
    <button onclick="openAdd()"       style="width:100%; margin:5px 0;">Ôºã –î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</button>
    <button onclick="openEditMode()"  style="width:100%; margin:5px 0;">‚úèÔ∏è –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
    <button onclick="openDeleteMode()"style="width:100%; margin:5px 0;">üóëÔ∏è –£–¥–∞–ª–∏—Ç—å</button>
    <button onclick="closeAdminMenu()"style="width:100%; margin:5px 0;">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <div id="adminForm"
       style="display:none; position:fixed; top:20%; left:50%; transform:translateX(-50%);
              background:#fff; padding:20px; box-shadow:0 4px 12px rgba(0,0,0,0.3);
              border-radius:8px; width:300px; z-index:1002;">
    <h3 id="formTitle">–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</h3>
    <input id="catTitle" type="text" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"
           style="width:100%; margin:5px 0; padding:8px;"/>
    <input id="catSlug"  type="text" placeholder="Slug ( –ª–∞—Ç–∏–Ω–∏—Ü–µ–π )"
           style="width:100%; margin:5px 0; padding:8px;"/>
    <input id="catDesc"  type="text" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"
           style="width:100%; margin:5px 0; padding:8px;"/>
    <input id="catImg"   type="text" placeholder="URL –∫–∞—Ä—Ç–∏–Ω–∫–∏"
           style="width:100%; margin:5px 0; padding:8px;"/>
    <button onclick="saveCategory()"
            style="width:100%; margin:5px 0; padding:8px;">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
    <button onclick="closeAdminForm()"
            style="width:100%; margin:5px 0; padding:8px;">–û—Ç–º–µ–Ω–∞</button>
  </div>

  <button id="addBtn"
          title="–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é"
          onclick="openAdd()"
          style="display:none; position:fixed; bottom:20px; right:20px;
                 width:50px; height:50px; font-size:32px; border:none;
                 border-radius:50%; background:var(--orange); color:var(--white);
                 box-shadow:0 2px 6px rgba(0,0,0,0.2);">Ôºã</button>

  <div id="instruction"
       style="display:none; position:fixed; top:80px; left:50%; transform:translateX(-50%);
              background:rgba(0,0,0,0.75); color:#fff; padding:10px 20px;
              border-radius:5px; font-size:16px; z-index:1002;"></div>

  <footer class="footer">
    <p>¬© 2025 –ú–∏—Ä –∫–æ–∂–∏ –∏ –∞–≤—Ç–æ—Ç–∫–∞–Ω–µ–π. –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã.</p>
  </footer>

  <script>
    const ADMIN_PW_ENC = 'YWRtaW4xMjM='; // 'admin123'
    const defaultCategories = [
      { title:'–≠–∫–æ-–∫–æ–∂–∞',         slug:'eco-leather',     desc:'–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –º–∞—Ç–µ—Ä–∏–∞–ª, —É—Å—Ç–æ–π—á–∏–≤—ã–π –∏ —ç–∫–æ–ª–æ–≥–∏—á–Ω—ã–π.', img:'eco-leather.jpg' },
      { title:'–ù–∞—Ç—É—Ä–∞–ª—å–Ω–∞—è –∫–æ–∂–∞', slug:'natural-leather', desc:'–ü—Ä–æ—á–Ω–∞—è, –¥–æ–ª–≥–æ–≤–µ—á–Ω–∞—è, –ø—Ä–µ–º–∏–∞–ª—å–Ω–æ–≥–æ –∫–∞—á–µ—Å—Ç–≤–∞.',   img:'natural-leather.jpg' },
      { title:'–§—É—Ä–Ω–∏—Ç—É—Ä–∞',        slug:'accessories',     desc:'–ó–∞–º–∫–∏, –∫–Ω–æ–ø–∫–∏, –Ω–∏—Ç–∫–∏, –∫—Ä–µ–ø–ª–µ–Ω–∏—è –∏ –¥—Ä—É–≥–æ–µ.',    img:'accessories.jpg' }
    ];
    let categories = JSON.parse(localStorage.getItem('categories')) || defaultCategories;
    localStorage.setItem('categories', JSON.stringify(categories));

    let adminMode = false, pendingOperation = null, editIndex = null;

    function renderCategories(){
      const c = document.getElementById('cards');
      c.innerHTML = '';
      categories.forEach((cat,i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${cat.img}" alt="${cat.title}">
          <div class="card-content">
            <h3 class="card-title">${cat.title}</h3>
            <p class="card-text">${cat.desc}</p>
          </div>`;
        if(adminMode && pendingOperation){
          card.style.cursor = 'pointer';
          card.addEventListener('click', ()=>handleCardClick(i));
        } else if(!adminMode){
          card.style.cursor = 'pointer';
          card.addEventListener('click', ()=> {
            window.location.href = `category.html?type=${cat.slug}`;
          });
        }
        c.appendChild(card);
      });
    }

    function handleCardClick(i){
      if(pendingOperation==='edit')   startEditCategory(i);
      if(pendingOperation==='delete') performDeleteCategory(i);
    }

    document.addEventListener('keydown', e=>{
      if(e.altKey && e.code==='KeyA'){
        e.preventDefault();
        document.getElementById('loginForm').style.display = 'block';
      }
    });

    function checkPassword(){
      const pw = document.getElementById('adminPassword').value.trim();
      if(pw === atob(ADMIN_PW_ENC)){
        adminMode = true;
        document.getElementById('adminToolbar').style.display = 'block';
        document.getElementById('addBtn').style.display       = 'block';
        document.getElementById('loginForm').style.display    = 'none';
        renderCategories();
      } else alert('–ù–µ–≤–µ—Ä–Ω—ã–π –ø–∞—Ä–æ–ª—å');
    }

    function openAdminMenu(){
      document.getElementById('adminMenu').style.display = 'block';
    }
    function closeAdminMenu(){
      document.getElementById('adminMenu').style.display = 'none';
    }

    function logoutAdmin(){
      adminMode = false; pendingOperation = null; editIndex = null;
      document.getElementById('adminToolbar').style.display = 'none';
      document.getElementById('addBtn').style.display       = 'none';
      closeAdminMenu(); closeAdminForm(); renderCategories();
    }

    function openAdd(){
      pendingOperation = null;
      clearForm();
      document.getElementById('formTitle').textContent   = '–î–æ–±–∞–≤–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é';
      document.getElementById('adminForm').style.display = 'block';
      closeAdminMenu(); hideInstruction();
    }

    function openEditMode(){
      pendingOperation = 'edit';
      closeAdminMenu();
      showInstruction('–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è');
      renderCategories();
    }

    function startEditCategory(i){
      editIndex = i;
      const cat = categories[i];
      document.getElementById('catTitle').value = cat.title;
      document.getElementById('catSlug').value  = cat.slug;
      document.getElementById('catDesc').value  = cat.desc;
      document.getElementById('catImg').value   = cat.img;
      document.getElementById('formTitle').textContent = '–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é';
      document.getElementById('adminForm').style.display = 'block';
      hideInstruction(); pendingOperation = null;
    }

    function openDeleteMode(){
      pendingOperation = 'delete';
      closeAdminMenu();
      showInstruction('–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è');
      renderCategories();
    }

    function performDeleteCategory(i){
      if(confirm(`–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´${categories[i].title}¬ª?`)){
        categories.splice(i,1);
        localStorage.setItem('categories', JSON.stringify(categories));
        alert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è —É–¥–∞–ª–µ–Ω–∞');
        renderCategories();
      }
      hideInstruction(); pendingOperation = null;
    }

    function saveCategory(){
      const t = document.getElementById('catTitle').value.trim();
      const s = document.getElementById('catSlug').value.trim();
      const d = document.getElementById('catDesc').value.trim();
      const i = document.getElementById('catImg').value.trim();
      if(!t||!s||!i) return alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è');
      const entry = { title:t, slug:s, desc:d, img:i };
      if(editIndex===null){
        categories.push(entry);
        alert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –¥–æ–±–∞–≤–ª–µ–Ω–∞');
      } else {
        categories[editIndex] = entry;
        alert('–ö–∞—Ç–µ–≥–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∞');
        editIndex = null;
      }
      localStorage.setItem('categories', JSON.stringify(categories));
      renderCategories(); closeAdminForm();
    }

    function closeAdminForm(){
      document.getElementById('adminForm').style.display = 'none';
      pendingOperation = null; hideInstruction();
    }

    function clearForm(){
      ['catTitle','catSlug','catDesc','catImg'].forEach(id=>
        document.getElementById(id).value = ''
      );
    }

    function showInstruction(txt){
      const ins = document.getElementById('instruction');
      ins.textContent = txt; ins.style.display = 'block';
    }
    function hideInstruction(){
      document.getElementById('instruction').style.display = 'none';
    }

    document.addEventListener('DOMContentLoaded', renderCategories);
  </script>
</body>
</html>
 